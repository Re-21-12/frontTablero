<section class="welcome">
  <header class="hero">
    <div class="avatar">{{ initials() }}</div>
    <div class="hero__text">
      <h2 class="hero__title">{{ horaSaludo() }}, {{ nombre() }}</h2>
      <p class="hero__meta">
        <span class="meta__item"><span class="dot"></span>Rol: <strong>{{ rol() }}</strong></span>
        <span class="meta__sep"></span>
        <span class="meta__item"><span class="dot"></span>Permisos: <strong>{{ permisos().length }}</strong></span>
        <span class="meta__sep"></span>
        <span class="meta__item"><span class="dot"></span>Usuario: <strong>{{ username() }}</strong></span>
        <span class="meta__sep"></span>
        <span class="meta__item">
          <span class="dot"></span>
          Email verificado:
          <strong>
            <span *ngIf="emailVerified(); else notVerified">Sí</span>
            <ng-template #notVerified>No</ng-template>
          </strong>
        </span>
      </p>
    </div>
    <div class="hero__cta">
      <button class="btn btn--primary" (click)="ir('/tablero')">Entrar al tablero</button>
    </div>
  </header>

  <div class="grid">
    <section class="card">
      <div class="card__head">
        <h3 class="card__title">Permisos principales</h3>
        <span class="pill">{{ permisos().length }} totales</span>
      </div>

      <div class="chips" *ngIf="permisos().length; else noPerms">
        <span class="chip" *ngFor="let p of permisosVisibles(); trackBy: trackByPerm">
          {{ p.nombre }}
        </span>

        <button type="button" class="chip chip--muted chip--action" *ngIf="restantes() > 0 && !viendoTodos()" (click)="togglePerms()">
          +{{ restantes() }} más
        </button>

        <button type="button" class="chip chip--muted chip--action" *ngIf="viendoTodos()" (click)="togglePerms()">
          Ver menos
        </button>
      </div>

      <ng-template #noPerms>
        <p class="muted">No se encontraron permisos para tu cuenta.</p>
      </ng-template>
    </section>

    <section class="card">
      <div class="card__head">
        <h3 class="card__title">Accesos rápidos</h3>
      </div>

      <div class="actions">
        <button class="btn btn--ghost" (click)="ir('/historial')">Ver historial</button>
        <button class="btn btn--ghost" (click)="ir('/recursos')">Recursos</button>
        <button class="btn btn--ghost" (click)="ir('/emails')">Emails</button>
        <button class="btn btn--ghost" *ngIf="puedeAdmin()" (click)="ir('/admin')">Administración</button>
      </div>

      <div class="card__footer">
        <button class="btn btn--ghost" (click)="ir('/inicio_sesion')">Cambiar de cuenta</button>
      </div>
    </section>
  </div>
</section>
